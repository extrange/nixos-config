# My NixOS Configuration

https://github.com/extrange/nixos-config/assets/29305375/d6c1ed13-6e20-4f08-81ee-dac268ea39cf

Each host has 3 files:

- home.nix
- system.nix
- hardware-configuration.nix (generated by `nixos-generate-config`)

In general, while it is possible for configuration to be very specific (e.g. icon sizes in Nautilus), it is better to prefer defaults as far as possible. This reduces the potential surface of things breaking as updates/changes happen, and lets me focus more on the overall architecture.

## Install

> [!IMPORTANT]
> Before installing anything, you will need to back up your existing configuration:
>
> - `~/.ssh` keys
> - Firefox profile directory
> - `/etc/fstab`
> - `nm-cli` connections (if applicable)
> - VM images (if applicable)

Boot into the NixOS [installer].

Setup partitions:

```text
$ sudo -i
# source <(curl -s https://raw.githubusercontent.com/extrange/nixos-config/main/setup-partitions.sh)
```

Follow the necessary instructions, then reboot.

## Post Install

- `git push` changes to `hardware-configuration.nix`
- Setup logins:
  - Tailscale
  - Telegram
  - Whatsapp
- Syncthing: configure folders, add device to server
- GSConnect pairing

## Notes

- `nixos-rebuild switch --flake .#hostname` will not allow access to untracked files. To [work around] this, do `nixos-rebuild switch --flake path:.#hostname`.
- Using `read` in `curl ... | bash` doesn't work as `read` does not have access to the terminal, so `source` is used instead.

[work around]: https://discourse.nixos.org/t/dirty-nixos-rebuild-build-flake-issues/30078/2
[installer]: https://channels.nixos.org/nixos-23.11/latest-nixos-minimal-x86_64-linux.iso
